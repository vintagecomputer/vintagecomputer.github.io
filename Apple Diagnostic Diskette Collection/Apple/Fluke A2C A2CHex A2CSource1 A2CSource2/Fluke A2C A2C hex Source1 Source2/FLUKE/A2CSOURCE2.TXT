PROGRAM TONE                              !PROGRAM NO.: 10   DPY-#TONE GENERATOR - ADJUST           !TONE GENERATION PROGRAM     DPY-+ VOLUME   REG1 = 32                              !REGISTER FOR COUNTER1: LABEL 1   WALK @ C030 = 1                        !ADDRESS TO TOGGLE SPEAKER    DEC REG1   IF REG1 > 0 GOTO 1E: LABEL EPROGRAM MOUSEBTTON                        !PROGRAM NO.: 11   DPY-#MOUSE BUTTON TEST                 !MOUSE BUTTON TEST    REGF = 45    EXECUTE PROGRAM NOP 1: LABEL 1   DPY-#HOLD DOWN MOUSE BUTTON            !HOLD DOWN BUTTON       REGF = 64    EXECUTE PROGRAM NOP    READ @ C063                            !MOUSE BUTTON DETECT ADDRESS   REGE = REGE AND 80    IF REGE = 80 GOTO B                    !ERR IF BIT 7 = 1   IF REGE = 0 GOTO AA: LABEL A   DPY-#RELEASE MOUSE BUTTON              !RELEASE BUTTON   REGF = 64    EXECUTE PROGRAM NOP    READ @ C063                            !BUTTON DETECT ADDRESS   REGE = REGE AND 80    IF REGE = 80 GOTO C                    !ERR DETECT   IF REGE = 0 GOTO F                     !CHECK FOR BUTTON RELEASEB: LABEL B   DPY-#IS MOUSE BUTTON PRESSED?A   IF REGA = 1 GOTO D   IF REGA = 0 GOTO 1C: LABEL C   DPY-#MOUSE BUTTON PASSED   REGF = 64    EXECUTE PROGRAM NOP    GOTO EF: LABEL F   DPY-#IS MOUSE BUTTON RELEASED?A   IF REGA = 1 GOTO D                     !GOTO FAIL MESSAGE   IF REGA = 0 GOTO AD: LABEL D   DPY-#MOUSE BUTTON FAILED   REGF = 64   EXECUTE PROGRAM NOP E: LABEL EPROGRAM LIST                              !PROGRAM NO.: 12   DPY-#APPLE IIC PROGRAM MENU            !MENU DISPLAY   REGF = 45    EXECUTE PROGRAM NOP    DPY-0 RUN ALL TESTS   REGF = 45   EXECUTE PROGRAM NOP    DPY-1 SHORT MAIN AND AUX MEM   DPY-+ TEST   REGF = 45   EXECUTE PROGRAM NOP    DPY-2 ROM TEST   REGF = 45   EXECUTE PROGRAM NOP    DPY-3 MMU/IOU TEST   REGF = 45   EXECUTE PROGRAM NOP    DPY-4 SERIAL PORT TEST   REGF = 45    EXECUTE PROGRAM NOP    DPY-5 KEYBOARD TEST   REGF = 45    EXECUTE PROGRAM NOP    DPY-6 SPEAKER TEST   REGF = 45   EXECUTE PROGRAM NOP    DPY-7 MOUSE BUTTON TEST   REGF = 45   EXECUTE PROGRAM NOP    DPY-8 DISK MOTOR TEST   REGF = 45   EXECUTE PROGRAM NOP F: LABEL FPROGRAM ROMTEST                           !PROGRAM NO.: 13   DPY-ROM TEST                           !MONITOR ROM TEST    READ @ C082                            !STATUS BIT TO IDENTIFY MACHINE   READ @ FBB3                            !STATUS BIT TO IDENTIFY MACHINE   IF REGE > 06 GOTO F                    !IF ADDRESS NOT EQUAL TO 06; ERR   IF 06 > REGE GOTO F   READ @ FBC0                            !STATUS BIT TO IDENTIY MACHINE       IF REGE > 00 GOTO F   REGF = 00    DPY-ROM TEST EXECUTING...70SEC         !DISPLAY MESSAGE   REGF = 45     EXECUTE PROGRAM NOP    ROM TEST @ C100 -FEFF SIG 83B7         !ROM LOCATION TO TEST        IF REGE > 14 GOTO F                    !ERROR CONDITIONS   IF 14 > REGE GOTO F   DPY-#ROM TEST PASSED                   !IF SIG IS 83B7; GOOD   REGF = 45    EXECUTE PROGRAM NOP    GOTO EF: LABEL F   DPY-ROM SUSPECT BAD#                   !ROM FAILED MESSAGE   REGF = 45    EXECUTE PROGRAM NOP E: LABEL EPROGRAM SERIALTST                         !PROGRAM NO.: 14     !PORT1 TO PORT2 AND PORT2 TO PORT1 TRANSMIT TEST   !0 - 19.2K BAUD TESTS      DPY-#SERIAL PORT TEST                  !SERIAL PORT TEST    REGF = 45    EXECUTE PROGRAM NOP 1: LABEL 1   DPY-#CONNECT SERIAL LOOPBACK           !CONNECT PLUG MESSAGE        DPY-+ PLUG.   REGF = 45    EXECUTE PROGRAM NOP 2: LABEL 2   DPY-#BEGIN TEST?A                      !WAIT FOR READY INDICATION   IF REGA = 0 GOTO 2   DPY-SERIAL PORT TEST..1.5 MINUTE       !TEST TIME MESSAGE      REGF = 45    EXECUTE PROGRAM NOP    DPY-PORT1-->PORT2 TRANSMIT..50         !PORT1 TO PORT2 TRANSMIT    DPY-+ SEC   REGF = 10   EXECUTE PROGRAM NOP    !INITIALIZING STATUS REGISTERS   WRITE @ C09A = 00                      !PORT1 COMMAND REGISTER   WRITE @ C09B = 00                      !PORT1 CONTROL REGISTER    WRITE @ C0AA = 00                      !PORT2 COMMAND REGISTER   WRITE @ C0AB = 00                      !PORT2 CONTROL REGISTER   WRITE @ C09A = 0B                      !SET-UP FOR TRANSMIT   !0B = ENABLE RECEIVER;DISABLE INTERRUPT;DISABLE TRASMIT INTERRUPT    WRITE @ C0AA = 0B                      !SET-UP PORT2   REG2 = 1F                              !BAUD RATE REGISTER3: LABEL 3   REG4 = 01 8: LABEL 8   WRITE @ C09B = REG2                    !PORT1 CONTROL REGISTER   WRITE @ C0AB = REG2                    !PORT2 CONTROL REGISTER   REG3 = 64                              !COUNTER TO DETERMINE IF4: LABEL 4                                !PORTS ARE READY    DEC REG3   READ @ C099                            !PORT1 STATUS REGISTER   REGE = REGE AND 10    IF REG3 = 00 GOTO E   IF REGE = 00 GOTO 4   WRITE @ C098 = REG4                    !PORT1 TEMP DATA STORAGE REG   REG3 = 64 5: LABEL 5   DEC REG3   READ @ C0A9                            !PORT2 STATUS REGISTER    REGE = REGE AND 08    IF REG3 = 00 GOTO E   IF REGE = 00 GOTO 5   READ @ C0A8                            !PORT2 TEMP DATA STORAGE REG   IF REGE = REG4 GOTO 6                  !ONE STRING TRANSMITTED   GOTO E6: LABEL 6   SHL REG4                               !SHIFT LEFT AND TRANSMIT AGAIN   IF REG4 = 100 GOTO 7   GOTO 8                                 !RETURN TO TRANSMIT AGAIN7: LABEL 7   DEC REG2                               !DECREMENT BAUD RATE    IF REG2 > 10 GOTO 3   DPY-#PORT1-->PORT2 PASSED              !PORT1 TO PORT2 COMPLETE   REGF = 45    EXECUTE PROGRAM NOP    EXECUTE PROGRAM SERIAL2                !PORT2 TO PORT1 TEST        GOTO FE: LABEL E   DPY-#SERIAL PORT FAILED.   REGF = 45    EXECUTE PROGRAM NOP    DPY-#IS LOOPBACK PLUG CONNECTED   DPY-+?A   IF REGA = 0 GOTO 1   DPY-TEST AGAIN?A                       !REPEAT CAPABILITY   IF REGA = 0 GOTO F!ABILTIY TO LOOP ON TEST TO BE GIVEN   DPY-LOOP ON SERIAL TEST?A   IF REGA = 0 GOTO 2   EXECUTE SERLOOP1     F: LABEL FPROGRAM SERLOOP1                         !PROGRAM NO.: 15!THIS PROGRAM WILL PERFORM A TRANSMIT FROM PORT 1 TO PORT 2 LOOP!TEST AT 9600 BAUD.   WRITE @ C09A = 00   WRITE @ C09B = 00   WRITE @ C0AA = 00   WRITE @ C0AB = 00   WRITE @ C09A = 0B                        WRITE @ C0AA = 0B   REG2 = 1E                             !BAUD RATE SETUP   WRITE @ C09B = REG2   WRITE @ C0AB = REG2   REG9 = 00                             !COUNT REGISTER 2: LABEL 2   DPY-SERIAL LOOP TEST 1-->2;PASS   DPY-+ @9   REGF = 45   EXECUTE PROGRAM NOP       WRITE @ C098 = REG4   INC REG9   GOTO 2F: LABEL F    PROGRAM SERIAL2                          !PROGRAM NO.: 169: LABEL 9   DPY-PORT2-->PORT1 TRANSMIT..50        !PORT2 TO PORT1 TRANSMIT   DPY-+ SEC   REGF = 45    EXECUTE PROGRAM NOP!SET-UP AND INITIALIZE REGISTERS    WRITE @ C09A = 00                     !PORT1 COMMAND REGISTER   WRITE @ C09B = 00                     !PORT1 CONTROL REGISTER   WRITE @ C0AA = 00                     !PORT2 COMMAND REGISTER   WRITE @ C0AB = 00                     !PORT2 CONTROL REGISTER   WRITE @ C09A = 0B                     !SET-UP PORT1   WRITE @ C0AA = 0B                     !SET-UP PORT2   REG2 = 1F                             !SET-UP BAUD RATE 19.2K1: LABEL 1   REG4 = 01 2: LABEL 2   WRITE @ C09B = REG2                   !PORT1 - SET-UP BAUD RATE    WRITE @ C0AB = REG2                   !PORT2 - SET-UP BAUD RATE   REG3 = 64                             !DECREMENTING READY REGISTER3: LABEL 3   DEC REG3   READ @ C0A9                           !STATUS REGISTER - PORT2   REGE = REGE AND 10    IF REG3 = 00 GOTO E   IF REGE = 00 GOTO 3   WRITE @ C0A8 = REG4                   !TEMP DATA REGISTER - PORT2   REG3 = 64 4: LABEL 4   DEC REG3   READ @ C099                           !STATUS REGISTER - PORT1    REGE = REGE AND 08    IF REG3 = 00 GOTO E   IF REGE = 00 GOTO 4   READ @ C098                           !TEMP DATA REGISTER - PORT1   IF REGE = REG4 GOTO 5   GOTO E5: LABEL 5   SHL REG4   IF REG4 = 100 GOTO 6   GOTO 26: LABEL 6   DEC REG2   IF REG2 > 10 GOTO 1   DPY-#PORT2-->PORT1 TRANSMIT PAS   DPY-+SED   REGF = 45   EXECUTE PROGRAM NOP    GOTO FE: LABEL E   DPY-#PORT2-->PORT1 FAILED   REGF = 45   EXECUTE PROGRAM NOP    DPY-#TEST AGAIN?A   IF REGA = 0 GOTO F   DPY-LOOP ON SERIAL TEST?A   IF REGA = 0 GOTO 9   EXECUTE SERLOOP2F: LABEL FPROGRAM SERLOOP2                         !PROGRAM NO.: 17!THIS PROGRAMS PERFORMS A PORT 2 TO PORT 1 TRANSMIT TEST.!THE TEST IS PERFORMED AT 9600 BAUD AND IS A LOOP TEST.    WRITE @ C09A = 00    WRITE @ C09B = 00    WRITE @ C0AA = 00    WRITE @ C0AB = 00    WRITE @ C09A = 0B    WRITE @ C0AA = 0B    REG2 = 1E                            !BAUD RATE REGISTER    WRITE @ C09B = REG2    WRITE @ C0AB = REG2    REG9 = 002:  LABEL 2    DPY-SERIAL LOOP TEST 2-->1;PASS    DPY-+ @9    REG4 = 01                            !BIT BEING SENT      WRITE @ C0A8 = REG4          INC REG9    GOTO 2F:  LABEL FPROGRAM KEYBOARD                         !PROGRAM NO.:  18  !THIS KEYBOARD TEST OFFERS A GENERIC AND SPECIFIC KEYBOARD!TEST.  GENERIC IMPLIES THE USER TYPES A KEY AND THE HEX!CODE IS DISPLAYED BY THE FLUKE FOR THE KEY PRESSED.  SPECIFIC!IS FOR A PARTICULAR KEYBOARD AND CERTAIN KEYS ARE CALLED OUT!TO PRESS.         DPY-#GENERIC/SPECIFIC KEYBOARD   DPY-+ TEST   REGF = 45    EXECUTE PROGRAM NOP    DPY-GENERIC = YES; SPECIFIC = N        !USER INPUT FOR TEST   DPY-+O?1                               !DESIRED   EXECUTE PROGRAM NOP    IF REG1 = 1 GOTO 90: LABEL 0   DPY-#READY FOR KEYBOARD TEST?1         !USER INPUT READY TO    IF REG1 = 0 GOTO 0                     !BEGIN1: LABEL 1                                !SPECIFIC KEYBOARD TO TEST   DPY-SELECT KEYBOARD TO TEST   REGF = 45   EXECUTE PROGRAM NOP    DPY-US KEYBOARD?1                      !US KEYBOARD   IF REG1 = 1 GOTO 2   DPY-BRITISH KEYBOARD?1                 !BRITISH KEYBOARD     IF REG1 = 1 GOTO 2   DPY-ITALIAN KEYBOARD?1                 !ITALIAN KEYBOARD    IF REG1 = 1 GOTO 3   DPY-FRENCH KEYBOARD?1                  !FRENCH KEYBOARD   IF REG1 = 1 GOTO 4   DPY-GERMAN KEYBOARD?1                  !GERMAN KEYBOARD   IF REG1 = 1 GOTO 5   DPY-WESTERN SPANISH?1                  !WESTERN SPANISH KEYBRD    IF REG1 = 1 GOTO 6   IF REG1 = 0 GOTO 1                     !GO BACK TO BEGINNING                                          !IF NONE SELECTED2: LABEL 2                                !US KEYBOARD TEST     EXECUTE PROGRAM STRBCLR                !CLEAR KEYBOARD STROBE    DPY-#PRESS "DELETE"   REG8 = 7F    REGF = 10   EXECUTE PROGRAM NOP    EXECUTE PROGRAM KEYCK                  !CHECK KEY PRESSED     DPY-#PRESS "RETURN"   REG8 = 0D    REGF = 10   EXECUTE PROGRAM NOP    EXECUTE PROGRAM KEYCK                  !CHECK KEY PRESSED    DPY-#PRESS "1"   REG8 = 31    REGF = 10   EXECUTE PROGRAM NOP     EXECUTE PROGRAM KEYCK                  !CHECK KEY PRESSED    DPY-#PRESS "Q"   REG8 = 71    REGF = 10    EXECUTE PROGRAM NOP    EXECUTE PROGRAM KEYCK                  !CHECK KEY PRESSED    DPY-#PRESS "A"   REG8 = 61    REGF = 10   EXECUTE PROGRAM NOP    EXECUTE PROGRAM KEYCK                  !CHECK KEY PRESSED     DPY-#PRESS "Z"   REG8 = 7A    REGF = 10   EXECUTE PROGRAM NOP    EXECUTE PROGRAM KEYCK                  !CHECK KEY PRESSED    DPY-#REPEAT TEST?1   IF REG1 = 1 GOTO 2   GOTO E3: LABEL 3                                !ITALIAN KEYBOARD TEST   EXECUTE PROGRAM STRBCLR                !CLEAR KEYBOARD STROBE    DPY-#PRESS "1"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 26    EXECUTE PROGRAM KEYCK                  !CHECK KEY PRESSED    DPY-#PRESS "6"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 7D    EXECUTE PROGRAM KEYCK                  !CHECK KEY PRESSED    DPY-#PRESS "0"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 5D    EXECUTE PROGRAM KEYCK                  !CHECK KEY PRESSED    DPY-#PRESS "><"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 3C    EXECUTE PROGRAM KEYCK                  !CHECK KEY PRESSED    DPY-#PRESS "DELETE"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 7F    EXECUTE PROGRAM KEYCK    DPY-#PRESS "RETURN"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 0D    EXECUTE PROGRAM KEYCK    DPY-#REPEAT TEST?1   IF REG1 = 1 GOTO 3   GOTO E4: LABEL 4                               !FRENCH KEYBOARD   DPY-#KEYBOARD SWITCH DOWN   REGF = 45   EXECUTE PROGRAM NOP    EXECUTE PROGRAM STRBCLR               !CLEAR KEYBOARD STROBE    DPY-#PRESS "1"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 31    EXECUTE PROGRAM KEYCK    DPY-#PRESS "W"   REGF = 10    EXECUTE PROGRAM NOP    REG8 = 7A    EXECUTE PROGRAM KEYCK    DPY-#PRESS "P"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 70    EXECUTE PROGRAM KEYCK    DPY-#PRESS "M"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 3B    EXECUTE PROGRAM KEYCK    DPY-#PRESS "DELETE"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 7F    EXECUTE PROGRAM KEYCK    DPY-#PRESS "RETURN"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 0D    EXECUTE PROGRAM KEYCK    DPY-#REPEAT TEST?1   IF REG1 = 1 GOTO 4   GOTO E5: LABEL 5                                   !GERMAN KEYBOARD TEST   EXECUTE PROGRAM STRBCLR                   !CLEAR KEYBOARD STROBE    DPY-#KEYBOARD SWITCH DOWN   REGF = 45    EXECUTE PROGRAM NOP    DPY-#PRESS "1"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 31    EXECUTE PROGRAM KEYCK                     !CHECK KEY PRESSED    DPY-#PRESS "><"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 5C    EXECUTE PROGRAM KEYCK    DPY-#PRESS "6"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 36    EXECUTE PROGRAM KEYCK    DPY-#PRESS "B"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 62    EXECUTE PROGRAM KEYCK    DPY-#PRESS "DELETE"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 7F    EXECUTE PROGRAM KEYCK    DPY-#PRESS "RETURN"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 0D    EXECUTE PROGRAM KEYCK    DPY-#REPEAT TEST?1   IF REG1 = 1 GOTO 5   GOTO E6: LABEL 6                                  !WESTERN SPANISH KEYBOARD   EXECUTE PROGRAM STRBCLR                  !CLEAR KEYBOARD STROBE    DPY-#PRESS "1"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 31    EXECUTE PROGRAM KEYCK    DPY-#PRESS "Q"   REGF = 10     EXECUTE PROGRAM NOP    REG8 = 51    EXECUTE PROGRAM KEYCK      DPY-#PRESS "A"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 41    EXECUTE PROGRAM KEYCK    DPY-#PRESS "Z"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 5A    EXECUTE PROGRAM KEYCK    DPY-#PRESS "DELETE"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 7F    EXECUTE PROGRAM KEYCK    DPY-#PRESS "RETURN"   REGF = 10   EXECUTE PROGRAM NOP    REG8 = 0D    EXECUTE PROGRAM KEYCK    DPY-#REPEAT TEST?1   IF REG1 = 1 GOTO 69: LABEL 9   EXECUTE PROGRAM GNRKEY                  !GENERIC KEYBOARD TESTE: LABEL EPROGRAM KEYCK                              !PROGRAM NO.: 19                                           !CHECK KEY PRESS PROGRAM      READ @ C010                             !CLEAR STROBE1: LABEL 1   READ @ C000                             !KEY PRESSED STROBE   REGE = REGE AND 80     IF REGE = 00 GOTO 1   READ C010   READ C000                               !READ KEY PRESSED   IF REGE = REG8 GOTO E    DPY-+<WAS $E NOT $8>   EXECUTE PROGRAM TONEERROR   REGF = 45    EXECUTE PROGRAM NOP E: LABEL E PROGRAM GNRKEY                             !PROGRAM NO.:  20!GENERIC KEYBOARD TEST; PRESS ANY KEY AND THE HEX CODE IS DISPLAYED   DPY-#ALL PURPOSE KEYBOARD TEST1: LABEL 1   DPY-#READY TO TEST KEYBOARD?A   IF REGA = 0 GOTO 1   EXECUTE PROGRAM STRBCLR                  !CLEAR KEYBOARD STROBE    DPY-#HEX CODE OF KEY PRESSED IS   DPY-+ SHOWN   REGF = 45    EXECUTE PROGRAM NOP3: LABEL 3      READ @ C0102: LABEL 2     READ @ C000    DPY-PRESS KEY   REGF = 10   EXECUTE PROGRAM NOP    REGE = REGE AND 80   IF REGE = 00 GOTO 2     READ @ C010   READ @ C000    DPY-#KEY PRESSED WAS <$E>   REGF = 50   EXECUTE PROGRAM NOP   GOTO 3 E: LABEL EPROGRAM STRBCLR                             !PROGRAM NO.:  21                                             !CLEAR KEYBOARD STROBE1: LABEL 1   READ @ C010    READ @ C000   REGE = REGE AND 80    IF REGE = 80 GOTO F   GOTO EF: LABEL F   DPY-#CAN'T CLEAR KYBRD STROB   DPY-+E...RPT?1   IF REG1 = 1 GOTO 1E: LABEL EPROGRAM DISKMTR                             !PROGRAM NO.: 22!TEST TURNS  ON AND OFF MOTOR   DPY-#DISK MOTOR TEST   REGF = 45   EXECUTE PROGRAM NOP 1: LABEL 1   DPY-TURN DRIVE ONE MOTOR ON   REGF = 45   EXECUTE PROGRAM NOP    READ @ C0E9                              !TURNS ON MOTOR   DPY-IS DISK ACCESS LIGHT ON?1   IF REG1 = 1 GOTO 2   DPY-TRY AGAIN?1   IF REG1 = 1 GOTO 1   DPY-UNABLE TO TURN ON DRIVE   REGF = 45   EXECUTE PROGRAM NOP    GOTO E2: LABEL 2   DPY-TURN OFF MOTOR                            READ @ C0E8                              !TURNS OFF MOTOR    DPY-#PASSED   REGF = 45   EXECUTE PROGRAM NOP E: LABEL E